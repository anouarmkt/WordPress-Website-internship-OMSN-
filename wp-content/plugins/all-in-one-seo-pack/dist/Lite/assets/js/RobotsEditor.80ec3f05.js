var v=Object.defineProperty,g=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var f=(t,e,s)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,n=(t,e)=>{for(var s in e||(e={}))R.call(e,s)&&f(t,s,e[s]);if(m)for(var s of m(e))S.call(e,s)&&f(t,s,e[s]);return t},p=(t,e)=>g(t,y(e));import{a as C,b as k,h as _,i as h,p as b,d as x}from"./index.d328c175.js";import{S as O}from"./ToolsSettings.004b222f.js";import"./helpers.db3922d1.js";import{n as P}from"./vueComponentNormalizer.87056a83.js";import{B as E}from"./Editor.22528024.js";import{B as N}from"./Radio.99a9886d.js";import{C as L}from"./Index.cb0f42fe.js";import{C as T}from"./Card.be971207.js";import{C as D}from"./SettingsRow.eb71f07b.js";import{C as J}from"./Tooltip.3ec20ff5.js";import{S as I}from"./Plus.a9b9ba75.js";import{S as z}from"./External.8868c638.js";import{S as B}from"./Trash.214b5744.js";import"./default-i18n.abde8d59.js";import"./isArrayLikeObject.a4a9229a.js";import"./Modal.1216ab78.js";import"./index.a4161053.js";import"./client.94d919c5.js";import"./_commonjsHelpers.f40d732e.js";import"./constants.a1b1778a.js";import"./cleanForSlug.e9a761bb.js";import"./Checkmark.e7547654.js";import"./QuestionMark.83ebd18e.js";import"./Slide.f5d21606.js";import"./Row.13b6f3f1.js";var U=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"aioseo-tools-robots-editor"},[s("core-card",{attrs:{slug:"robotsEditor","header-text":t.strings.robotsEditor}},[s("div",{staticClass:"aioseo-settings-row aioseo-section-description"},[t._v(" "+t._s(t.strings.description)+" "),s("br"),s("br"),t._v(" "+t._s(t.strings.description2)+" "),s("span",{domProps:{innerHTML:t._s(t.$links.getDocLink(t.$constants.GLOBAL_STRINGS.learnMore,"robotsEditor",!0))}})]),t.$aioseo.data.robots.hasPhysicalRobots&&t.options.tools.robots.robotsDetected?s("div",{staticClass:"aioseo-settings-row physical-robots"},[s("core-alert",{attrs:{type:"red","show-close":""},on:{"close-alert":t.hideRobotsDetected}},[t._v(" "+t._s(t.strings.physicalRobotsFound)+" "),s("div",{staticClass:"buttons"},[s("base-button",{attrs:{type:"blue",size:"medium",loading:t.importLoading},on:{click:t.importAndDeleteRobots}},[t._v(" "+t._s(t.strings.importAndDelete)+" ")]),s("base-button",{attrs:{type:"blue",size:"medium",loading:t.deleteLoading},on:{click:t.deleteRobots}},[t._v(" "+t._s(t.strings.delete)+" ")])],1)])],1):t._e(),t.$aioseo.data.robots.rewriteExists?t._e():s("div",{staticClass:"aioseo-settings-row rewrite-exists"},[s("core-alert",{attrs:{type:"red"},domProps:{innerHTML:t._s(t.missingRewriteRules)}})],1),s("core-settings-row",{attrs:{name:t.$constants.GLOBAL_STRINGS.preview,align:""},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"aioseo-sitemap-preview"},[s("base-button",{attrs:{size:"medium",type:"blue",tag:"a",href:t.$aioseo.urls.robotsTxtUrl,target:"_blank"}},[s("svg-external"),t._v(" "+t._s(t.strings.openRobotsTxt)+" ")],1)],1)]},proxy:!0}])}),t.$aioseo.data.subdomain||t.$aioseo.data.mainSite?s("core-settings-row",{attrs:{name:t.strings.enableCustomRobots},scopedSlots:t._u([{key:"content",fn:function(){return[s("base-toggle",{model:{value:t.options.tools.robots.enable,callback:function(i){t.$set(t.options.tools.robots,"enable",i)},expression:"options.tools.robots.enable"}})]},proxy:!0}],null,!1,1538436598)}):t._e(),!t.$aioseo.data.subdomain&&!t.$aioseo.data.mainSite?s("core-alert",{attrs:{type:"blue"},domProps:{innerHTML:t._s(t.subdirectoryAlert)}}):t._e(),t.$aioseo.data.subdomain||t.$aioseo.data.mainSite?s("div",{staticClass:"aioseo-settings-row"},[s("div",{staticClass:"settings-content"},[this.hasErrors?s("core-alert",{attrs:{type:"red"}},[t._v(" "+t._s(t.strings.duplicateOrInvalid)+" ")]):t._e(),s("div",{staticClass:"robots-table"},[s("div",{staticClass:"robots-header"},[s("div",{staticClass:"robots-user-agent"},[t._v(t._s(t.strings.userAgent))]),s("div",{staticClass:"robots-rule"},[t._v(t._s(t.strings.rule))]),s("div",{staticClass:"robots-directory-path"},[t._v(t._s(t.strings.directoryPath))]),s("div",{staticClass:"robots-actions"})]),s("div",{staticClass:"robots-rows"},t._l(t.parsedRules,function(i,a){return s("div",{key:a,staticClass:"robots-row",class:{even:a%2===0}},[s("div",{staticClass:"robots-user-agent"},[s("base-input",{ref:"userAgent",refInFor:!0,class:t.hasError(i.userAgent+i.rule+i.directoryPath),attrs:{value:i.userAgent,size:"medium",placeholder:t.strings.userAgentPlaceholder,disabled:!t.options.tools.robots.enable},on:{blur:function(d){return t.updateRule("userAgent",d,a)}}})],1),s("div",{staticClass:"robots-rule"},[s("base-radio",{ref:"allow",refInFor:!0,attrs:{name:"rule-"+a,value:i.rule==="allow",disabled:!t.options.tools.robots.enable,size:"medium",type:2},on:{input:function(d){return t.updateRule("rule","allow",a)}}},[t._v(" "+t._s(t.strings.allow)+" ")]),s("base-radio",{ref:"disallow",refInFor:!0,attrs:{name:"rule-"+a,value:i.rule==="disallow",disabled:!t.options.tools.robots.enable,size:"medium",type:2},on:{input:function(d){return t.updateRule("rule","disallow",a)}}},[t._v(" "+t._s(t.strings.disallow)+" ")])],1),s("div",{staticClass:"robots-directory-path"},[s("base-input",{key:t.inputKey,class:t.hasError(i.userAgent+i.rule+i.directoryPath),attrs:{value:i.directoryPath,size:"medium",placeholder:t.strings.directoryPathPlaceholder,disabled:!t.options.tools.robots.enable},on:{blur:function(d){return t.updateRule("directoryPath",d,a)}}})],1),s("div",{staticClass:"robots-actions"},[t.options.tools.robots.enable?s("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.strings.deleteRule)+" ")]},proxy:!0}],null,!0)},[s("svg-trash",{nativeOn:{click:function(d){return t.removeRow(a)}}})],1):t._e()],1)])}),0)]),s("base-button",{attrs:{type:"blue",size:"medium",disabled:!t.options.tools.robots.enable},on:{click:t.addRow}},[s("svg-circle-plus"),t._v(" "+t._s(t.strings.addRule)+" ")],1)],1)]):t._e(),t.$aioseo.data.subdomain||t.$aioseo.data.mainSite?s("div",{staticClass:"aioseo-settings-row"},[s("div",{staticClass:"settings-name"},[s("div",{staticClass:"name"},[t._v(t._s(t.strings.robotsPreview))])]),s("div",{staticClass:"settings-content"},[s("base-editor",{attrs:{value:t.robotsTxt,"line-numbers":!0,"minimum-line-numbers":13,disabled:"","force-updates":"",monospace:""}})],1)]):t._e()],1)],1)},A=[];const F={userAgent:null,rule:"allow",directoryPath:null},W={components:{BaseEditor:E,BaseRadio:N,CoreAlert:L,CoreCard:T,CoreSettingsRow:D,CoreTooltip:J,SvgCirclePlus:I,SvgExternal:z,SvgTrash:B},mixins:[O],data(){return{inputKey:0,importLoading:!1,deleteLoading:!1,errors:{},strings:{robotsEditor:this.$t.__("Robots.txt Editor",this.$td),description:this.$t.sprintf(this.$t.__("The robots.txt editor in %1$s allows you to set up a robots.txt file for your site that will override the default robots.txt file that WordPress creates. By creating a robots.txt file with %2$s you have greater control over the instructions you give web crawlers about your site.",this.$td),"AIOSEO","AIOSEO"),description2:this.$t.sprintf(this.$t.__("Just like WordPress, %1$s generates a dynamic file so there is no static file to be found on your server.  The content of the robots.txt file is stored in your WordPress database.",this.$td),"All in One SEO"),enableCustomRobots:this.$t.__("Enable Custom Robots.txt",this.$td),duplicateOrInvalid:this.$t.__("Duplicate or invalid entries have been detected! Please check your rules and try again.",this.$td),userAgent:this.$t.__("User Agent",this.$td),rule:this.$t.__("Rule",this.$td),directoryPath:this.$t.__("Directory Path",this.$td),allow:this.$t.__("Allow",this.$td),disallow:this.$t.__("Disallow",this.$td),addRule:this.$t.__("Add Rule",this.$td),deleteRule:this.$t.__("Delete Rule",this.$td),robotsPreview:this.$t.__("Robots.txt Preview:",this.$td),openRobotsTxt:this.$t.__("Open Robots.txt",this.$td),physicalRobotsFound:this.$t.sprintf(this.$t.__("%1$s has detected a physical robots.txt file in the root folder of your WordPress installation. We recommend removing this file as it could cause conflicts with WordPress' dynamically generated one. %2$s can import this file and delete it, or you can simply delete it.",this.$td),"AIOSEO","AIOSEO"),importAndDelete:this.$t.__("Import and Delete",this.$td),delete:this.$t.__("Delete",this.$td)}}},watch:{options:{deep:!0,handler(){this.validateRules()}}},computed:p(n(n({},C(["options"])),k(["getNetworkRobotsRules"])),{parsedRules(){return this.options.tools.robots.rules.map(t=>JSON.parse(t))},robotsTxt(){const t=JSON.parse(JSON.stringify(this.$aioseo.data.multisite&&!this.$aioseo.data.network?this.getNetworkRobotsRules:{})),e=JSON.parse(JSON.stringify(this.$aioseo.data.robots.defaultRules)),s=`\r
`+this.$aioseo.data.robots.sitemapUrls.filter(i=>0<i.length).join(`\r
`);return this.options.tools.robots.enable?_(h(n({},e),h(n({},t),b(this.options.tools.robots.rules)),!1,!0))+s:_(h(n({},e),n({},t)))+s},hasErrors(){return Object.keys(this.errors).length},subdirectoryAlert(){return this.$t.sprintf(this.$t.__("This site is running in a sub-directory of your main site located at %1$s. Your robots.txt file should only appear in the root directory of that site.",this.$td),'<a href="'+this.$aioseo.urls.mainSiteUrl+'" target="_blank"><strong>'+this.$aioseo.urls.mainSiteUrl+"</strong></a>")},missingRewriteRules(){const t=this.$t.__("It looks like you are missing the proper rewrite rules for the robots.txt file.",this.$td);let e="";return this.$aioseo.data.server.apache?e=this.$t.sprintf(this.$t.__("It appears that your server is running on Apache, so the fix should be as simple as checking the %1$scorrect .htaccess implementation on wordpress.org%2$s.",this.$td),'<a href="https://wordpress.org/support/article/htaccess/" target="_blank">',"</a>"):this.$aioseo.data.server.nginx&&(e=e=this.$t.sprintf(this.$t.__("It appears that your server is running on nginx, so the fix will most likely require adding the correct rewrite rules to our nginx configuration. %1$sCheck our documentation for more information%2$s.",this.$td),'<a href="'+this.$links.getDocUrl("robotsRewrite")+'" target="_blank">',"</a>")),t+" "+e}}),methods:p(n({},x(["processButtonAction"])),{removeRow(t){this.$delete(this.options.tools.robots.rules,t),this.options.tools.robots.rules.length||this.addRow(),this.validateRules()},addRow(){this.options.tools.robots.rules.push(JSON.stringify(n({},F))),this.$nextTick(()=>{this.$refs.userAgent[this.options.tools.robots.rules.length-1].$el.querySelector(".robots-user-agent input").focus()})},updateRule(t,e,s){const i=JSON.parse(this.options.tools.robots.rules[s]);i[t]=e,this.$set(this.options.tools.robots.rules,s,JSON.stringify(i)),t==="directoryPath"&&(i[t]=this.sanitizePath(e),this.inputKey++,this.$set(this.options.tools.robots.rules,s,JSON.stringify(i))),this.validateRules(),t==="rule"&&this.$nextTick(()=>this.$refs[e][s].$el.querySelector("input").focus())},sanitizePath(t){return t.slice(t.length-1)!=="*"&&!t.includes(".")&&(t=this.$links.trailingSlashIt(t)),t.charAt(0)!=="/"&&(t="/"+t),t.toLowerCase()},hasError(t){return this.errors[t]?"aioseo-error":""},validateRules(){if(this.errors={},!this.options.tools.robots.enable)return;const t={},e=JSON.parse(JSON.stringify(this.$aioseo.data.multisite&&!this.$aioseo.data.network?this.getNetworkRobotsRules:{})),s=JSON.parse(JSON.stringify(this.$aioseo.data.robots.defaultRules)),i=h(n({},s),b(this.options.tools.robots.rules,!0),!0);Object.keys(i).forEach(o=>{const u=i[o];t[o]||(t[o]={allow:[],disallow:[]}),u.allow.forEach(r=>{if(t[o].allow.includes(r)){this.errors[o+"allow"+r]=!0;return}t[o].allow.push(r)}),u.disallow.forEach(r=>{if(t[o].disallow.includes(r)){this.errors[o+"disallow"+r]=!0;return}t[o].disallow.push(r)})});const a={},d=h(n({},e),b(this.options.tools.robots.rules,!0),!0);Object.keys(d).forEach(o=>{const u=d[o];a[o]||(a[o]={allow:[],disallow:[]}),u.allow.forEach(r=>{if(a[o].allow.includes(r)){this.errors[o+"allow"+r]=!0;return}else if(a[o].disallow.includes(r)){this.errors[o+"allow"+r]=!0,this.errors[o+"disallow"+r]=!0;return}const c="^"+r.replace(".","\\.").replace("/","\\/").replace("*","(.*)")+"$";if(a[o].allow.some(l=>l&&l.match(c))||a[o].disallow.some(l=>l&&l.match(c))){this.errors[o+"allow"+r]=!0,this.errors[o+"disallow"+r]=!0;return}a[o].allow.push(r)}),u.disallow.forEach(r=>{if(a[o].disallow.includes(r)){this.errors[o+"disallow"+r]=!0;return}else if(a[o].allow.includes(r)){this.errors[o+"allow"+r]=!0,this.errors[o+"disallow"+r]=!0;return}const c="^"+r.replace(".","\\.").replace("/","\\/").replace("*","(.*)")+"$";if(a[o].allow.some(l=>l&&l.match(c))||a[o].disallow.some(l=>l&&l.match(c))){this.errors[o+"allow"+r]=!0,this.errors[o+"disallow"+r]=!0;return}a[o].disallow.push(r)})})},importAndDeleteRobots(){this.importLoading=!0,this.processButtonAction("tools/import-robots-txt").then(()=>{window.location.reload()})},deleteRobots(){this.deleteLoading=!0,this.processButtonAction("tools/delete-robots-txt").then(()=>{window.location.reload()})},hideRobotsDetected(){this.options.tools.robots.robotsDetected=!1,this.saveChanges()}}),mounted(){this.validateRules(),this.options.tools.robots.rules.length||this.addRow()}},$={};var j=P(W,U,A,!1,G,null,null,null);function G(t){for(let e in $)this[e]=$[e]}var _t=function(){return j.exports}();export{_t as default};
